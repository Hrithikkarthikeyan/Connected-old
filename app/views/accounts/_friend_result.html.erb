
<div class="results-block">
  <%= render 'layouts/messages' %>
</div>
<% if @friends.count > 0 %>
<% if @friends %> 
  <div class="card card-header results-block">
  <table class="col-md-12" style="border: 1px;">
  <thead>
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
    <tbody>
  <% @friends.each do |friend| %>
    <tr>
    <td><%= link_to friend.full_name, account_path(friend)%></td>
    <td><%= friend.email %></td>
    <td>
    <% if Request.where(account_id: current_account, friend_id: friend.id, status: 0).exists?%>
      <%= link_to 'Undo Request', request_path(Request.find_by(account_id: current_account, friend_id: friend.id)), method: :delete, data: {confirm: 'Are you sure?'},
                                            class: 'btn btn-sm btn-danger' %>
    <% elsif current_account.not_friends_with?(friend.id)%>
      <% if friend.company? %>
       <%= link_to 'Follow?', friendships_path(account: friend, friend: current_account),
                            class: "btn btn-sm btn-success", method: :post %>  
      <% else %>
      <%= link_to 'Connect?', requests_path(friend: friend),
                            class: "btn btn-sm btn-success", method: :post %>   
      <% end %>              
    <% else %>
      <span class="badge badge-secondar">
        You are connections
        </span>
    <% end  %>
    </td>
                          
    </tr>
  <% end %>
  </tbody>
  </table>
  </div>
<% end %> 
<% end %>